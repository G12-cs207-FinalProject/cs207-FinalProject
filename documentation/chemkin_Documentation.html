<h1 id="chemical-kinetics-library">Chemical Kinetics Library</h1>



<h2 id="1-introduction">1. Introduction</h2>

<p><code>chemkin</code> stands for chemical kinetics and is an objected-oriented library for modeling the kinetics of chemical reactions.</p>



<h3 id="11-key-chemical-kinetics-concepts">1.1 Key Chemical Kinetics Concepts</h3>

<p>Chemical kinetics is the study of rates of chemical processes such as reaction rates, reaction mechanisms, etc. as well as the construction of mathematical models that can describe the characteristics of a chemical reaction (<a href="https://en.wikipedia.org/wiki/Chemical_kinetics">wikipedia</a>). Typically, amounts of molecular species reacted (consumed)/formed and the rates of their consumption/formation are of interest.</p>

<p>Chemical reactions can be categorized as elementary or non-elementary and reversible or irreversible. Each class of chemical reactions can be modeled by ODEs (ordinary differential equations) or PDEs (partial differntial equations) using different strategies.</p>



<h4 id="irreversible-elementary-reaction"><em>Irreversible Elementary Reaction</em></h4>

<p>For a system  consisting of <script type="math/tex" id="MathJax-Element-383">N</script> species undergoing <script type="math/tex" id="MathJax-Element-384">M</script> <strong>irreversible</strong>, <strong>elementary</strong> reactions of the form:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-385">\sum_{i=1}^{N}{\nu_{ij}^{\prime}{s}_{i}} \longrightarrow 
  \sum_{i=1}^{N}{\nu_{ij}^{\prime\prime}{s}_{i}}, \qquad \text{for } j = 1, \ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-386">s_{i}</script> = Chemical symbol of specie <script type="math/tex" id="MathJax-Element-387">i</script>  <br>
<script type="math/tex" id="MathJax-Element-388">\nu_{ij}^{\prime}</script> = Stoichiometric coefficients of reactants  <br>
<script type="math/tex" id="MathJax-Element-389">\nu_{ij}^{\prime\prime}</script> = Stoichiometric coefficients of products</p>

<p>The <strong>rate of change of species <script type="math/tex" id="MathJax-Element-390">i</script></strong> (i.e. the <strong>reaction rate of species <script type="math/tex" id="MathJax-Element-391">i</script></strong>) can be written as</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-392">\begin{aligned}
  f_{i} = \frac{d[i]}{dt} = \sum_{j=1}^{M}{\nu_{ij}\omega_{j}} \qquad i = 1, \ldots, N
\end{aligned}</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-393">\nu_{ij}</script> = <script type="math/tex" id="MathJax-Element-394">\nu_{ij}^{\prime\prime}</script> - <script type="math/tex" id="MathJax-Element-395">\nu_{ij}^{\prime}</script>  <br>
<script type="math/tex" id="MathJax-Element-396">\omega_{j}</script> = Progress rate of reaction <script type="math/tex" id="MathJax-Element-397">j</script></p>

<p>The <strong>progress rate <script type="math/tex" id="MathJax-Element-398">\omega_{j}</script></strong> for reaction <script type="math/tex" id="MathJax-Element-399">j</script> is given by </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-400">\begin{aligned}
  \omega_{j} = k_{j}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime}}} \qquad j = 1, \ldots, M
\end{aligned}
</script> <br>
where  <br>
<script type="math/tex" id="MathJax-Element-401">k_{j}</script> = Forward reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-402">j</script> <br>
<script type="math/tex" id="MathJax-Element-403">x_{i}</script> = Concentration of specie <script type="math/tex" id="MathJax-Element-404">i</script></p>

<p>There are several types of <strong>forward reaction rate coefficient <script type="math/tex" id="MathJax-Element-405">k_{j}</script></strong>, including - </p>

<p><strong>Constant coefficient</strong>: coefficient  is constant for all reaction temperatures</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-406">k_{j} = k_{j}</script></p>

<p><strong>Arrhenius coefficient</strong>:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-407">k_{j} = A \cdot exp^{-E_a/(RT)}</script></p>

<p><strong>Modified Arrhenius coefficient</strong>:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-408">k_{j} = AT^{b}exp^{-E_a/(RT)}</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-409">A</script> = Arrhenius prefactor <br>
<script type="math/tex" id="MathJax-Element-410">b</script> = Modified Arrhenius paramter <br>
<script type="math/tex" id="MathJax-Element-411">E_a</script> = Activation energy <br>
<script type="math/tex" id="MathJax-Element-412">R</script> = Ideal gas constant <br>
<script type="math/tex" id="MathJax-Element-413">T</script> = Temperature</p>

<p>Note: A complete table of notation of <strong>irreversible elementary</strong> reaction</p>

<table>
<thead>
<tr>
  <th align="center">Symbol</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody><tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-414">\mathcal{s}_{i}</script></td>
  <td>Chemical symbol of specie <script type="math/tex" id="MathJax-Element-415">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-416">\nu_{ij}^{\prime}</script></td>
  <td>Stoichiometric coefficients of reactants</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-417">\nu_{ij}^{\prime\prime}</script></td>
  <td>Stoichiometric coefficients of products</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-418">N</script></td>
  <td>Number of species in system</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-419">M</script></td>
  <td>Number of elementary reactions</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-420">f_{i}</script></td>
  <td>Rate of consumption or formation of specie <script type="math/tex" id="MathJax-Element-421">i</script> (reaction rate)</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-422">\omega_{j}</script></td>
  <td>Progress rate of reaction <script type="math/tex" id="MathJax-Element-423">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-424">x_{i}</script></td>
  <td>Concentration of specie <script type="math/tex" id="MathJax-Element-425">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-426">k_{j}</script></td>
  <td>Reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-427">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-428">A</script></td>
  <td>Arrhenius prefactor</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-429">b</script></td>
  <td>Modified Arrhenius paramter</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-430">R</script></td>
  <td>Ideal gas constant</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-431">E_a</script></td>
  <td>Activation energy</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-432">T</script></td>
  <td>Temperature</td>
</tr>
</tbody></table>




<h4 id="reversible-elementary-reaction"><em>Reversible Elementary Reaction</em></h4>

<p>For a system  consisting of <script type="math/tex" id="MathJax-Element-433">N</script> species undergoing <script type="math/tex" id="MathJax-Element-434">M</script> <strong>reversible</strong>, <strong>elementary</strong> reactions of the form:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-435">\sum_{i=1}^{N}{\nu_{ij}^{\prime}\mathcal{s}_{i}}  \rightleftharpoons \sum_{i=1}^{N}{\nu_{ij}^{\prime\prime}\mathcal{s}_{i}} \qquad j = 1, \ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-436">\mathcal{s}_{i}</script> = Chemical symbol of specie <script type="math/tex" id="MathJax-Element-437">i</script>  <br>
<script type="math/tex" id="MathJax-Element-438">\nu_{ij}^{\prime}</script> = Stoichiometric coefficients of reactants  <br>
<script type="math/tex" id="MathJax-Element-439">\nu_{ij}^{\prime\prime}</script> = Stoichiometric coefficients of products</p>

<p>The <strong>rate of change of species <script type="math/tex" id="MathJax-Element-440">i</script></strong> (i.e. the <strong>reaction rate of species <script type="math/tex" id="MathJax-Element-441">i</script></strong>) can be written as</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-442">\begin{aligned}
  f_{i} = \frac{d[i]}{dt} = \sum_{j=1}^{M}{\nu_{ij}r_{j}} \qquad i = 1, \ldots, N
\end{aligned}</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-443">\nu_{ij}</script> = <script type="math/tex" id="MathJax-Element-444">\nu_{ij}^{\prime\prime}</script> - <script type="math/tex" id="MathJax-Element-445">\nu_{ij}^{\prime}</script>  <br>
<script type="math/tex" id="MathJax-Element-446">r_{j}</script> = Total progress rate of reaction <script type="math/tex" id="MathJax-Element-447">j</script></p>

<p>The <strong>total progress rate <script type="math/tex" id="MathJax-Element-448">r_{j}</script></strong> of reaction <script type="math/tex" id="MathJax-Element-449">j</script> is given by</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-450">r_{j} = k_{j}^{\left(f\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime}}} - k_{j}^{\left(b\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime\prime}}}, \qquad j = 1,\ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-451">k_{j}^{\left(f\right)}</script> = Forward reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-452">j</script> <br>
<script type="math/tex" id="MathJax-Element-453">k_{j}^{\left(b\right)}</script> = Backward reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-454">j</script> <br>
<script type="math/tex" id="MathJax-Element-455">x_{i}</script> = Concentration of specie <script type="math/tex" id="MathJax-Element-456">i</script></p>

<p>The <strong>backward reaction rate coefficient <script type="math/tex" id="MathJax-Element-457">k_{j}^{\left(b\right)}</script></strong> is given by</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-458">k_{j}^{\left(b\right)} = \frac{k_{j}^{\left(f\right)}}{k_{j}^{e}}, \qquad j =1, \ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-459">k_{j}^{e}</script> = Equilibrium constant for reaction <script type="math/tex" id="MathJax-Element-460">j</script></p>

<p>The <strong>equilibrium constant  <script type="math/tex" id="MathJax-Element-461">k_{j}^{e}</script></strong> is related to the equilibrium thermochemistry of the elementary reactions, and it is given by</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-462">k_{j}^{e} = \left(\frac{p_{0}}{RT}\right)^{\gamma_{j}}\exp\left(\frac{\Delta S_{j}}{R} - \frac{\Delta H_{j}}{RT}\right), \qquad j =1, \ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-463">\gamma_{j} = \sum_{i=1}^{N}{\nu_{ij}}</script> <br>
<script type="math/tex" id="MathJax-Element-464">p_{0}</script> = Pressure of the reactor (e.g. <script type="math/tex" id="MathJax-Element-465">10^{5}</script> Pa) <br>
<script type="math/tex" id="MathJax-Element-466">\Delta S_{j}</script> = Entropy change of reaction <script type="math/tex" id="MathJax-Element-467">j</script> <br>
<script type="math/tex" id="MathJax-Element-468">\Delta H_{j}</script> = Enthalpy change of reaction <script type="math/tex" id="MathJax-Element-469">j</script></p>

<p>Read more about <a href="https://en.wikipedia.org/wiki/Equilibrium_constant">Equilibrium constant</a></p>

<p>The <strong>entropy change <script type="math/tex" id="MathJax-Element-470">\Delta S_{j}</script></strong> and the <strong>enthalpy change <script type="math/tex" id="MathJax-Element-471">\Delta H_{j}</script></strong> of reaction <script type="math/tex" id="MathJax-Element-472">j</script> is given by </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-473">\Delta S_{j} = \sum_{i=1}^{N}{\nu_{ij}S_{i}} = \sum_{i=1}^{N}{\nu_{ij}\int_{T_{0}}^{T}{\frac{C_{p,i}\left(T\right)}{T} \ \mathrm{d}T}} \qquad j =1, \ldots, M</script></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-474">\Delta H_{j} = \sum_{i=1}^{N}{\nu_{ij}H_{i}} = \sum_{i=1}^{N}{\nu_{ij}\int_{T_{0}}^{T}{C_{p,i}\left(T\right) \ \mathrm{d}T}} \qquad j =1, \ldots, M</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-475">C_{p,i}</script> = Specific heat at constant pressure of species <script type="math/tex" id="MathJax-Element-476">i</script></p>

<p>The <strong>specific heat at constant pressure <script type="math/tex" id="MathJax-Element-477">C_{p,i}</script></strong> is given by a polynomial in <script type="math/tex" id="MathJax-Element-478">T</script> (called the NASA polynomial),</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-479">C_{p,i} = \left(\sum_{k=1}^{5}{a_{ik}T^{k-1}}\right)R, \qquad i = 1, \ldots, N.</script></p>

<p>where <br>
<script type="math/tex" id="MathJax-Element-480">T</script> = Temperature <br>
<script type="math/tex" id="MathJax-Element-481">R</script> = Ideal gas constant</p>

<p>The integrated forms of <script type="math/tex" id="MathJax-Element-482">\Delta S_{j}</script>,  <script type="math/tex" id="MathJax-Element-483">\Delta H_{j}</script>, <script type="math/tex" id="MathJax-Element-484">C_{p,i}</script>, using <script type="math/tex" id="MathJax-Element-485">7^{th}</script> order NASA polynomials are:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-486">\frac{C_{p,i}}{R} = a_{i1} + a_{i2}T + a_{i3}T^{2} + a_{i4}T^{3} + a_{i5}T^{4}</script></p>

<p><br></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-487">\frac{H_{i}}{RT} = a_{i1} + \frac{1}{2}a_{i2}T + \frac{1}{3}a_{i3}T^{2} + \frac{1}{4}a_{i4}T^{3} + \frac{1}{5}a_{i5}T^{4} + \frac{a_{i6}}{T}</script></p>

<p><br></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-574">\frac{S_{i}}{R} = a_{i1}\ln\left(T\right) + a_{i2}T + \frac{1}{2}a_{i3}T^{2} + \frac{1}{3}a_{i4}T^{3} + \frac{1}{4}a_{i5}T^{4} + a_{i7}</script></p>

<p><br></p>

<p>for <script type="math/tex" id="MathJax-Element-575">i = 1, \ldots, N</script>.</p>

<p>Note: A complete table of notation of <strong>reversible elementary</strong> reacion</p>

<table>
<thead>
<tr>
  <th align="center">Symbol</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody><tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-576">\mathcal{s}_{i}</script></td>
  <td>Chemical symbol of specie <script type="math/tex" id="MathJax-Element-577">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-578">\nu_{ij}^{\prime}</script></td>
  <td>Stoichiometric coefficients of reactants</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-579">\nu_{ij}^{\prime\prime}</script></td>
  <td>Stoichiometric coefficients of products</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-580">N</script></td>
  <td>Number of species in system</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-581">M</script></td>
  <td>Number of elementary reactions</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-582">f_{i}</script></td>
  <td>Rate of consumption or formation of specie <script type="math/tex" id="MathJax-Element-583">i</script> (reaction rate)</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-584">r_{j}</script></td>
  <td>Total progress rate of reaction <script type="math/tex" id="MathJax-Element-585">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-586">x_{i}</script></td>
  <td>Concentration of specie <script type="math/tex" id="MathJax-Element-587">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-588">k_{j}^{\left(f\right)}</script></td>
  <td>Forward reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-589">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-590">k_{j}^{\left(b\right)}</script></td>
  <td>Backward reaction rate coefficient for reaction <script type="math/tex" id="MathJax-Element-591">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-592">k_{j}^{e}</script></td>
  <td>Equilibrium constant for reaction <script type="math/tex" id="MathJax-Element-593">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-594">p_{0}</script></td>
  <td>Pressure of the reactor</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-595">\Delta S_{j}</script></td>
  <td>Entropy change of reaction <script type="math/tex" id="MathJax-Element-596">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-597">\Delta H_{j}</script></td>
  <td>Enthalpy change of reaction <script type="math/tex" id="MathJax-Element-598">j</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-599">S_{i}</script></td>
  <td>Entropy of species <script type="math/tex" id="MathJax-Element-600">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-601">H_{i}</script></td>
  <td>Enthalpy of species <script type="math/tex" id="MathJax-Element-602">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-603">C_{p,i}</script></td>
  <td>Specific heat at constant pressure of species <script type="math/tex" id="MathJax-Element-604">i</script></td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-605">T</script></td>
  <td>Temperature</td>
</tr>
<tr>
  <td align="center"><script type="math/tex" id="MathJax-Element-606">R</script></td>
  <td>Ideal gas constant</td>
</tr>
</tbody></table>




<h3 id="12-the-chemkin-library">1.2 The <code>chemkin</code> Library</h3>

<p>The high level functionality of the <strong>chemkin</strong> module is to take an XML file with reaction data as input and outputs the RHS (right-hand-side) of the ODE describing the rate of change of all molecular species involved in the chemical reaction(s) of interest (i.e. for <strong>irreversible elementary</strong> reaction: <script type="math/tex" id="MathJax-Element-607">\sum_{j=1}^{M}{\nu_{ij}\omega_{j}}, \text{ for } i = 1, \ldots, N</script>, and for <strong>reversible elementary</strong> reaction: <script type="math/tex" id="MathJax-Element-608">\sum_{j=1}^{M}{\nu_{ij}r_{j}}, \text{ for } i = 1, \ldots, N</script>).</p>

<p>Features of the <strong>chemkin</strong> module include:</p>

<ul>
<li><p>Parsing XML file with chemical reaction data to extract relevant parameters</p></li>
<li><p>Handling the calculation of 3+ classes of forward reaction rate coefficients (e.g. constant, Arrhenius and modified Arrhenius) given the appropriate parameters</p></li>
<li><p>Handling the calculation of backward reaction rate coefficients for <strong>reversible</strong> <strong>elementary</strong> reactions</p></li>
<li><p>Handling the calculation of progress rates (<script type="math/tex" id="MathJax-Element-609">\omega_{j}</script> or <script type="math/tex" id="MathJax-Element-610">r_{j}</script>) and reaction rates (<script type="math/tex" id="MathJax-Element-611">f_{i}</script>)  for a system  consisting of <script type="math/tex" id="MathJax-Element-612">N</script> species undergoing <script type="math/tex" id="MathJax-Element-613">M</script> <strong>irreversible</strong> or <strong>reversible</strong> <strong>elementary</strong> reactions</p></li>
<li><p>Computing species concentrations given a end time point <script type="math/tex" id="MathJax-Element-614">t_{end}</script></p></li>
<li><p>Visualizing time evolution of species concentration in the reaction system as well as visualizing of the time to reach a dynamic equilibrium for each reaction</p></li>
</ul>



<h4 id="overall-structure-of-the-chemkin-library">Overall structure of the <code>chemkin</code> library</h4>



<pre class="prettyprint"><code class="language-sh hljs avrasm">chemkin/
    __init__<span class="hljs-preprocessor">.py</span>
    chemkin_errors<span class="hljs-preprocessor">.py</span>
    preprocessing/
        __init__<span class="hljs-preprocessor">.py</span>
        parse_xml<span class="hljs-preprocessor">.py</span>
        tests/
            test_parse_xml<span class="hljs-preprocessor">.py</span>
    reaction/
        __init__<span class="hljs-preprocessor">.py</span>
        base_rxn<span class="hljs-preprocessor">.py</span>
        elementary_rxn<span class="hljs-preprocessor">.py</span>
        non_elementary_rxn<span class="hljs-preprocessor">.py</span>
        reaction_coefficients<span class="hljs-preprocessor">.py</span>
        tests/
            test_base_rxn<span class="hljs-preprocessor">.py</span>
            test_elementary_rxn<span class="hljs-preprocessor">.py</span>
            test_non_elementary_rxn<span class="hljs-preprocessor">.py</span>
            test_reaction_coefficients<span class="hljs-preprocessor">.py</span>
    thermodynamics/
        __init__<span class="hljs-preprocessor">.py</span>
        thermo<span class="hljs-preprocessor">.py</span>
        NASA_coef<span class="hljs-preprocessor">.sqlite</span>
        tests/
            test_thermo<span class="hljs-preprocessor">.py</span>
    viz/
        __init__<span class="hljs-preprocessor">.py</span>
        summary<span class="hljs-preprocessor">.py</span>
        tests/
            test_summary<span class="hljs-preprocessor">.py</span>
    solver/
        __init__<span class="hljs-preprocessor">.py</span>
        ODEint_solver<span class="hljs-preprocessor">.py</span>
        tests/
            __init__<span class="hljs-preprocessor">.py</span>
            test_ODEint_solver<span class="hljs-preprocessor">.py</span>
    xml-files/</code></pre>

<p>A brief description of each subdirectory:</p>

<ul>
<li><p><code>chemkin_errors</code> module hosts functions to detect library-related errors.</p></li>
<li><p><code>preprocessing</code> package contains modules to parse input files, extracts and returns relevant reaction parameters into a python dictionary. Currently, the library only parses .xml input files.</p></li>
<li><p><code>reaction</code> package contains modules to handle different reaction types (calculating progress rates, reaction rates, species concentrations and time to equilibrium) as well as calculating reaction rate coefficients</p></li>
<li><p><code>thermodynamics</code> package contains module to process thermodynamics-related parameters using the NASA_coef SQL database</p></li>
<li><p><code>solver</code> package contains an ODE solver, upon which reaction objects call to solve for the concentrations of reaction species as a function of time as well as the time to reach reaction equilibrium (both for individual reactions in the system and the overall equilibrium)</p></li>
<li><p><code>viz</code> package contains modules that allow the user to visualize reaction kinetics (e.g. printing reaction rates in a prettified, tabular format, plotting species concentration evolution)</p></li>
</ul>



<h2 id="2-installation">2. Installation</h2>

<p>The neccessary code can be found at and downloaded from <a href="https://github.com/G12-cs207-FinalProject/cs207-FinalProject">here</a>.</p>

<p>It is also pip-installable using the following command:</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>pip install chemkin</code></pre>

<p>You can specify the directory of installation using the following command:</p>



<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>pip install -t [installation directory] chemkin</code></pre>

<p>You can run the test suite on your local machine by typing the following command in your command line when in the directory of the installed module.</p>



<pre class="prettyprint"><code class="language-sh hljs ruby"><span class="hljs-variable">$ </span>cd [installation directory]
<span class="hljs-variable">$ </span>pytest</code></pre>

<p>If you wish to contribute to the further development of this library, please do not hesitate to consult with the IACS department at Harvard University Graduate School of Arts and Sciences <a href="https://iacs.seas.harvard.edu/">here</a>.</p>



<h2 id="3-basic-usage">3. Basic Usage</h2>



<h3 id="31-structure-of-the-input-file">3.1 Structure of the input file</h3>

<p>Chemical reaction data should be stored in XML format with the following specifications:</p>

<ol>
<li><p>a <code>&lt;phase&gt;</code> element with a <code>&lt;speciesArray&gt;</code> child element which lists the molecular species invovled in the reaction</p></li>
<li><p>a <code>&lt;reactionData&gt;</code> element that stores relevant parameters of the reaction:</p>

<ul><li><code>&lt;reaction reversible&gt;</code> tag indicates whether a reaction is reversible or irreversible, possible values = [“yes”, “no”]</li>
<li><code>&lt;type&gt;</code> tag indicates whether a reaction is elementary or non-elementary, possible values = [“Elementary”, “Non-Elementary]</li>
<li><code>&lt;equation&gt;</code> tag specifies the chemical reaction</li>
<li><code>&lt;rateCoeff&gt;</code> tag stores parameters relevant to calculate the rate coefficient. It has a child tag indicating the rate coefficient class, which can be one of three acceptable types, each of which dictates what coefficient values are parsed by the <code>XmlParser</code> class: <br>
<ol><li><code>&lt;Arrhenius&gt;</code>: Coefficients [A, E] will be retrieved.</li>
<li><code>&lt;modifiedArrhenius&gt;</code>: [A, b, E] will be retrieved.</li>
<li><code>&lt;Constant&gt;</code>: k will be retrieved.</li>
<li><code>&lt;equation&gt;</code>: Equation expression for each reaction will be retrieved.</li></ol></li></ul></li>
</ol>

<p><strong>Note</strong> There should be only 1 system of reactions per XML file (i.e. 1 <code>&lt;reactionData&gt;</code> element). If more than 1 <code>&lt;reactionData&gt;</code> element resides within the XML, only the first <code>&lt;reactionData&gt;</code> element (i.e. first system of reactions) will be considered.</p>

<p><strong>Note</strong> While it is not recommended, there can be a mix reversible and irreversible reactions in a system of chemical reactions. To check if more than 1 type of reaction is specified in the XML file and to count the number of reversible reactions in the system, please see <strong>Example 3.6</strong>.</p>

<p><strong>Note</strong> If no recognized child tag of <code>&lt;rateCoeff&gt;</code> is encountered, then <code>XmlParser</code> will raise a <code>ChemKinError</code>. Also, its retrieval of elements is case-sensitive. So, for example, <code>&lt;A&gt;</code>, <code>&lt;b&gt;</code>, <code>&lt;E&gt;</code>, and <code>&lt;k&gt;</code> must be used to store the appropriate coefficients; elements named <code>&lt;a&gt;</code>, <code>&lt;B&gt;</code>, <code>&lt;e&gt;</code> or <code>&lt;K&gt;</code> would not be recognized and would lead to an error.</p>

<p><strong>Note</strong> If the user inputs <code>&lt;type = Non-elementary&gt;</code> or <code>&lt;type = Nonelementary&gt;</code>, the <code>XmlParser</code> will raise a <code>ChemKinError</code> as our library does not handle this type of reactions.</p>

<p><strong>Example 3.1.</strong> XML file for the following chemical reaction: <br>
<script type="math/tex; mode=display" id="MathJax-Element-615">
\begin{aligned}
2H_2 + O_2 \quad \longrightarrow \quad 2OH + H_2
\end{aligned}
</script></p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">ctml</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">phase</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">speciesArray</span>&gt;</span> H2 O2 OH HO2 H2O <span class="hljs-tag">&lt;/<span class="hljs-title">speciesArray</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">phase</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reactionData</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"test_mechanism"</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- reaction 01  --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"no"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction01"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>2H2 + O2 [=] 2OH + H2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">A</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"m3/mol/s"</span>&gt;</span>1e+8<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>0.5<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">E</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"J/mol"</span>&gt;</span>5e+04<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2:2 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>OH:2 H2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reactionData</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">ctml</span>&gt;</span></code></pre>



<h3 id="32-reading-and-parsing-the-input-file">3.2 Reading and parsing the input file</h3>

<p>Reading and parsing the input XML file is handled in the <code>preprocessing</code> package, where there are two related classes that allow the user to work with reaction data stored in XML files.</p>

<ul>
<li><code>XmlParser</code></li>
<li><code>RxnData</code></li>
</ul>



<h4 id="321-xmlparser">3.2.1 <code>XmlParser</code></h4>

<p>The <code>XmlParser</code> class pulls reaction data from XML files and preprocesses the data (e.g. calculates the reaction rate coefficients from given paramters) with its <code>parsed_data_list(Ti)</code> method. <code>parsed_data_list(Ti)</code> takes a list of temperatures as input and returns a <code>list</code> of <code>dictionaries</code> that contain relevant reaction parameters at each of the temperatures.</p>

<p>Each dictionary in the returned list contains the following attributes:</p>

<ul>
<li><p><code>species</code>: a list of moleucular species invovled in the reaction</p></li>
<li><p><code>ki</code>: a list of forward reaction rate coefficients, the <script type="math/tex" id="MathJax-Element-616">i^{th}</script> entry in the list is the coefficient for the <script type="math/tex" id="MathJax-Element-617">i^{th}</script> reaction in the system</p></li>
<li><p><code>b_ki</code>: a list of backward reaction rate coefficients, the <script type="math/tex" id="MathJax-Element-618">i^{th}</script> entry in the list is the coefficient for the <script type="math/tex" id="MathJax-Element-619">i^{th}</script> reaction in the system (this attribute is 0 for irreversible reactions)</p></li>
<li><p><code>sys_vi_p</code>: a list of stoichemotetric coefficients of the reactants, the <script type="math/tex" id="MathJax-Element-620">i^{th}</script> entry in the list is the coefficients for the <script type="math/tex" id="MathJax-Element-621">i^{th}</script> reaction in the system</p></li>
<li><p><code>sys_vi_dp</code>: a list of stoichemotetric coefficients of the products, the <script type="math/tex" id="MathJax-Element-622">i^{th}</script> entry in the list is the coefficients for the <script type="math/tex" id="MathJax-Element-623">i^{th}</script> reaction in the system</p></li>
<li><p><code>is_reversible</code>: an indicator of whether the reaction is reversible (takes on values of True or False)</p></li>
<li><p><code>T</code>: a float of reaction temperature</p></li>
</ul>

<p><strong>Example 3.2.</strong> Read in, parse and preprocess an input XML file</p>



<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser

Ti = [<span class="hljs-number">100</span>, <span class="hljs-number">750</span>, <span class="hljs-number">1500</span>, <span class="hljs-number">2500</span>, <span class="hljs-number">5000</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>] 

xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))
parsed_data_list = xml_parser.parsed_data_list(Ti)</code></pre>

<p>The <code>parsed_data_list(Ti)</code> method abstracts much of the preprocssing stage, including calculating the reaction rate coefficients. However, there are instances where the user might want to simply extract XML elements (e.g. if the user wishes to calculate the reaction rate coefficients in an user-specified manner). The <code>XmlParser</code> module also allows the user to work directly with XML elements with its <code>load()</code> method. <code>load</code> returns a <code>tuple</code> of two lists:</p>

<ul>
<li><p>the species invovled in all the reactions in the file</p></li>
<li><p>list of <code>RxnData</code> objects, with each object containing the data for an individual reaction (discussed in next section)</p></li>
</ul>

<p><strong>Example 3.3.</strong> Read in and parse XML file to work with XML elements directly</p>



<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser

xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))
species, reaction_data = xml_parser.load()</code></pre>



<h4 id="322-rxndata">3.2.2 <code>RxnData</code></h4>

<p>The reaction data parsed by the XmlParser <code>load()</code> function from XML files is returned as a list of <code>RxnData</code> objects. This class encapsulates relevant information from the XML file in a way that allows the caller to easily process reactions differently according to their features.</p>

<p><code>RxnData</code> objects have the following attributes:</p>

<ul>
<li><p><code>rxn_id</code>: a string for reaction ID</p></li>
<li><p><code>reversible</code>: a boolean indicating whether the reaction is reversible</p></li>
<li><p><code>type</code>: a RxnType object from the Enum class indicating whether a reaction is elementary or  non-elementary</p></li>
<li><p><code>rate_coef</code>: a list of parameters for reaction rate coefficient</p></li>
<li><p><code>reactants</code>: a dictionary with molecular species of the reactants as keys and their respective stoichiometric coefficient as values</p></li>
<li><p><code>products</code>: a dictionary with molecular speicies of the products as keys and their respective stoichiometric coefficient as values</p></li>
<li><p><code>equation</code>: a list of equations for each reaction.</p></li>
</ul>

<p><strong>Example 3.4.</strong> Working with <code>RxnData</code> objects</p>



<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path 
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser

xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))
_, reaction_data = xml_parser.load()

<span class="hljs-keyword">for</span> rxn <span class="hljs-keyword">in</span> reaction_data:
    <span class="hljs-keyword">if</span> rxn.reversible:
        <span class="hljs-comment"># Handle special reversible reaction logic</span></code></pre>



<h3 id="33-calculating-kinetic-parameters-of-interest">3.3. Calculating kinetic parameters of interest</h3>

<p>Two families of modules in the <code>reaction</code> package allow you to compute kinetic paramters such as reaction rate coefficients, progress rates and reaction rates.</p>

<ul>
<li><p><code>reaction_coefficients</code> module handles calculations of reaction rate coefficients</p></li>
<li><p><code>base_rxn</code>, <code>elementary_rxn</code> and <code>non_elementary_rxn</code> modules handle calculations of progress rates, reaction rates, species concentrations at a given time, evolution of species concentrations and time to reach equilibrium.</p></li>
</ul>



<h4 id="331-reactioncoefficients-module">3.3.1. <code>reaction_coefficients</code> module</h4>

<p>The <code>reaction_coefficients</code> module contains a base class <code>RxnCoefficientBase</code> for forward reaction coefficients, from which then the three subclasses (<code>ConstantCoefficient</code>,<code>ArrheniusCoefficient</code>, and <code>ModifiedArrheniusCoefficient</code>) inherit its basic properties (such as <code>init</code>,<code>__repr__</code> and <code>__eq__</code>). When creating the instances of these classes, their parameters are based on inputs extracted using the <code>load</code> method from the <code>XmlParser</code> class and stored in <code>RxnData</code> object. As documented above, <code>RxnData</code> objects have a <code>rate_coef</code> attribute, which is a list of parameters for reaction rate coefficient. The list can have the following entires: temperature <script type="math/tex" id="MathJax-Element-624">T</script>, Arrhenius constant <script type="math/tex" id="MathJax-Element-625">A</script> (where applicable), modified constant <script type="math/tex" id="MathJax-Element-626">b</script> (where applicable), ideal gas constant <script type="math/tex" id="MathJax-Element-627">R</script>, and Activation energy <script type="math/tex" id="MathJax-Element-628">E</script>.</p>

<p>Since different classes of rate coefficients have different number of input parameters, we can utilize the length of the <code>rate_coef</code> to determine the class to use to calculate the reaction rate coefficients. The <code>get_coeff()</code> method handls the calculation of the the rate coefficients <script type="math/tex" id="MathJax-Element-629">ki</script> for reaction <script type="math/tex" id="MathJax-Element-630">i</script>. </p>

<p><strong>Example 3.5.</strong> Calculating forward reaction rate coefficients</p>



<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser

xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))

_, reaction_data = xml_parser.load()

coef_params = reaction_data.rate_coeff

        <span class="hljs-keyword">if</span> isinstance(coef_params, list):
            <span class="hljs-keyword">if</span> len(coef_params) == <span class="hljs-number">3</span>: <span class="hljs-comment"># modified arrhenius coef</span>
                A = coef_params[<span class="hljs-number">0</span>]
                b = coef_params[<span class="hljs-number">1</span>]
                E = coef_params[<span class="hljs-number">2</span>]
                ki.append(ModifiedArrheniusCoefficient(A, b, E, T).get_coef())
            <span class="hljs-keyword">else</span>: <span class="hljs-comment"># arrhenius coef</span>
                A = coef_params[<span class="hljs-number">0</span>]
                E = coef_params[<span class="hljs-number">1</span>]
                ki.append(ArrheniusCoefficient(A, E, T).get_coef())
        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># const coef</span>
            ki.append(ConstantCoefficient(coef_params).get_coef())</code></pre>

<p>The <code>reaction_coefficients</code> module also contains a separate class of <code>BackwardCoefficient</code>, which calculates the backward reaction rate coefficient for reversible chemical reactions.</p>



<h4 id="332-baserxn-module">3.3.2 <code>base_rxn</code> module</h4>

<p>The <code>base_rxn</code> module contains a single <code>RxnBase</code> class, from which the subclasses in <code>elementary_rxn</code> and <code>non_elementary_rxn</code> modules inherit. The <code>RxnBase</code> base class and its subclasses have methods to calculate the progress rates, reaction rates, species concentrations at a given time, time evolution of species concentrations and time to reach equilibrium given data on a system of chemical reactions and associated parameters.</p>

<p><code>RxnBase</code> objects have the following attributes:</p>

<ul>
<li><code>ki</code>: a list of forward reaction rate coefficients</li>
<li><code>b_ki</code>: a list of backward reaction rate coefficients</li>
<li><code>xi</code>: a list of concentrations of molecular species</li>
<li><code>vi_p</code>: a list of stoichiometric coefficients of the reactants</li>
<li><code>vi_dp</code>: a list of stoichiometric coefficients of the product</li>
<li><code>wi</code>: a list of total progress rates</li>
<li><code>f_wi</code>: a list of forward progress rates</li>
<li><code>b_wi</code>: a list of backward progress rates</li>
<li><code>rates</code>: a list of reaction rates</li>
<li><code>is_reversible</code>: a list of booleans indicating whether <script type="math/tex" id="MathJax-Element-631">i^{th}</script> reaction is reversible</li>
</ul>

<p><strong>Note</strong> These attributes are initialized when <code>RxnBase</code> objects are created. For example,</p>



<pre class="prettyprint"><code class=" hljs lua">reaction1 = RxnBase(ki=[<span class="hljs-number">10</span>, <span class="hljs-number">10</span>], b_ki=[<span class="hljs-number">20</span>, <span class="hljs-number">20</span>], xi=[<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">1.0</span>], vi_p=<span class="hljs-string">[[1.0, 2.0, 0.0], [2.0, 0.0, 2.0]]</span>, vi_dp=<span class="hljs-string">[[0.0, 0.0, 2.0], [0.0, 1.0, 1.0]]</span>)</code></pre>

<p><code>RxnBase</code> objects have the following methods:</p>

<ul>
<li><p><code>progress_rate()</code>: Returns a list of progress rates for the system (Not implemented in the base class)</p></li>
<li><p><code>reaction_rate()</code>: Returns a list of reaction rates for the system (Not implemented in the base class)</p></li>
<li><p><code>species_concentration(self, T, end_t, n_steps=101)</code>: Returns a list of species concentrations at temperature = T and end time = end_t (n_steps specifies the number of time steps for the ODE solver)</p></li>
<li><p><code>species_concentration_evolution(self, T, end_t, n_steps=101)</code>:  Returns a matrix of species concentration evolution at temperature = T and from start to end_t  (n_steps specifies the number of time steps for the ODE solver)</p></li>
<li><p><code>time_to_equilibrium(self, T, n_steps=101)</code>: Returns the list of time to equilibrium of all the reactions and the time to equilibrium of the overall system at temperature = T  (n_steps specifies the number of time steps for the ODE solver)</p></li>
</ul>

<h4 id="333-elementaryrxn-module">3.3.3 <code>elementary_rxn</code> module</h4>

<p>The <code>elementary_rxn</code> module deals with elementary chemical reactions. It contains an <code>ElementaryRxn</code> base class which inhertis from <code>RxnBase</code> and handles both <strong>irreversible</strong> and <strong>reversible</strong> elementary reactions.</p>

<p><strong>The <code>ElementaryRxn</code> class</strong></p>

<p>This class handles reversible, irreversible, and a mix thereof reactions in a chemical system.</p>

<p><strong>Irreversible Reactions</strong> </p>

<p>Consider a system consisting of <script type="math/tex" id="MathJax-Element-632">N</script> species undergoing <script type="math/tex" id="MathJax-Element-633">M</script> <strong>irreversible</strong>, <strong>elementary</strong> reactions of the form:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-634">\sum_{i=1}^{N}{\nu_{ij}^{\prime}\mathcal{s}_{i}} \longrightarrow 
  \sum_{i=1}^{N}{\nu_{ij}^{\prime\prime}\mathcal{s}_{i}}, \qquad \text{for } j = 1, \ldots, M</script></p>

<p>The progress rate <script type="math/tex" id="MathJax-Element-635">\omega_{j}</script> is given by </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-636">\begin{aligned}
  \omega_{j} = k_{j}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime}}}, \qquad j = 1, \ldots, M
\end{aligned}
</script></p>

<p>The reaction rate <script type="math/tex" id="MathJax-Element-637">f_{i} = \frac{d[i]}{dt}</script> is given by</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-638">\begin{aligned}
  f_{i} = \frac{d[i]}{dt} = \sum_{j=1}^{M}{\nu_{ij}\omega_{j}}, \qquad \text{for } i = 1, \ldots, N
\end{aligned}</script></p>

<p><strong>Reversible Reactions</strong></p>

<p>This class handles a system  consisting of <script type="math/tex" id="MathJax-Element-639">N</script> species undergoing <script type="math/tex" id="MathJax-Element-640">M</script> <strong>reversible</strong>, <strong>elementary</strong> reactions of the form:</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-641">\sum_{i=1}^{N}{\nu_{ij}^{\prime}\mathcal{s}_{i}}  \rightleftharpoons \sum_{i=1}^{N}{\nu_{ij}^{\prime\prime}\mathcal{s}_{i}} \qquad j = 1, \ldots, M</script></p>

<p>The total progress rate <script type="math/tex" id="MathJax-Element-642">r_{j}</script> is given by </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-643">r_{j} = k_{j}^{\left(f\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime}}} - k_{j}^{\left(b\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime\prime}}}, \qquad j = 1,\ldots, M</script></p>

<p>The reaction rate <script type="math/tex" id="MathJax-Element-644">f_{i} = \frac{d[i]}{dt}</script> is given by</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-645">\begin{aligned}
  f_{i} = \frac{d[i]}{dt} = \sum_{j=1}^{M}{\nu_{ij}r_{j}}, \qquad \text{for } i = 1, \ldots, N
\end{aligned}</script></p>

<p><code>ElementaryRxn</code> shares the same class attributes as the base class, inherits <code>species_concentration(self, T, end_t, n_steps=101)</code>, <code>species_concentration_evolution(self, T, end_t, n_steps=101)</code>, <code>time_to_equilibrium(self, T, n_steps=101)</code> methods and implements the two methods in the following manner: </p>

<ul>
<li><p><code>progress_rate()</code>: Returns a list of <script type="math/tex" id="MathJax-Element-646">k_{j}^{\left(f\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime}}} - k_{j}^{\left(b\right)}\prod_{i=1}^{N}{x_{i}^{\nu_{ij}^{\prime\prime}}}</script></p></li>
<li><p><code>reaction_rate()</code>: Returns a list of <script type="math/tex" id="MathJax-Element-647">\sum_{j=1}^{M}{\nu_{ij}r_{j}}</script></p></li>
</ul>



<h4 id="334-nonelementaryrxn-module">3.3.4 <code>non_elementary_rxn</code> module</h4>

<p>The implementation for non-elementary reactions is TBD.</p>



<h3 id="34-visualizing-kinetic-parameters-of-interest">3.4. Visualizing kinetic parameters of interest</h3>

<p>The <code>viz</code> package contains the <code>summary</code> module allows various visualizations of kinetic parameters of interest.</p>

<h4 id="341-summary-module">3.4.1. <code>summary</code> module</h4>

<p>The methods in the <code>summary</code> module is roughly divided into 2 high-level functions: 1) printing kinetic parameters of interest in prettified tabular format; and 2) plotting kinetic parameters of interest </p>

<p>For printing tables of kinetic parameters:</p>

<ul>
<li><p><code>print_reaction_rate(parsed_data_list, xi)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. The method prints reactions rates in tabular format. </p></li>
<li><p><code>print_species_concentration(parsed_data_list, xi, n_steps=101, end_t=1e-12)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method, species concentrations <code>xi</code>, and an end-time <code>end_t</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method prints species concentration at <code>end_t</code> in tabular format. </p></li>
<li><p><code>print_time_to_equilibrium(parsed_data_list, xi, n_steps=101)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method prints time to reach equilibrium for each reaction in the system. </p></li>
</ul>

<p>For plotting kinetic parameters:</p>

<ul>
<li><p><code>plot_species_concentration(parsed_data_list, xi, n_steps=101, end_t=1e-12)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method, species concentrations <code>xi</code>, and an end-time <code>end_t</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method saves the line plot to the <code>viz/examples</code> directory. </p></li>
<li><p><code>plot_time_to_equilibrium(parsed_data_list, xi, n_steps=101)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method saves the bar chart to the <code>viz/examples</code> directory. </p></li>
</ul>

<h2 id="4-examples">4. Examples</h2>



<h3 id="41-a-system-of-irreversible-elementary-chemical-reactions">4.1. A system of irreversible, elementary chemical reactions</h3>

<ul>
<li>The system of chemical reactions of interest:</li>
</ul>



<p><script type="math/tex; mode=display" id="MathJax-Element-648">
\begin{aligned}
2H_2 + O_2 &\longrightarrow 2OH + H_2 \\
OH + HO_2 &\longrightarrow H_2O + O_2 \\
H_2O + O_2 &\longrightarrow HO_2 + OH
\end{aligned}
</script></p>

<ul>
<li>Input XML file:</li>
</ul>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0"?&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ctml</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">phase</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">speciesArray</span>&gt;</span> H2 O2 OH HO2 H2O <span class="hljs-tag">&lt;/<span class="hljs-title">speciesArray</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">phase</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reactionData</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"test_mechanism"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- reaction 01  --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"no"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction01"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>2H2 + O2 [=] 2OH + H2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">A</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"m3/mol/s"</span>&gt;</span>1e+8<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>0.5<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">E</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"J/mol"</span>&gt;</span>5e+04<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2:2 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>OH:2 H2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- reaction 02 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"no"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction02"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>OH + HO2 [=] H2O + O2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Constant</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">k</span>&gt;</span>1e+4<span class="hljs-tag">&lt;/<span class="hljs-title">k</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">Constant</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>OH:1 HO2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H2O:1 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- reaction 03 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"no"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction03"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H2O + O2 [=] HO2 + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">A</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"m3/mol/s"</span>&gt;</span>1e+7<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">E</span> <span class="hljs-attribute">units</span>=<span class="hljs-value">"J/mol"</span>&gt;</span>1e+04<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2O:1 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>HO2:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reactionData</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ctml</span>&gt;</span></code></pre>



<h4 id="411-printing-reaction-rates">4.1.1 Printing reaction rates</h4>

<p>This example demonstrates the highest-level and most-abstracted use of the library. The user simply specifies the temperatures and initial species concentrations with the corresponding input XML file which contains the reaction data, and the following code prints reaction rates in a prettified, tabular format. </p>

<ul>
<li>Given the the species concentration <script type="math/tex" id="MathJax-Element-649">xi = [2.0, 1.0, 0.5, 1.0, 1.0]</script> in units of <script type="math/tex" id="MathJax-Element-650">(mol/dm^3)</script>, calculate the reaction rate of each species at <script type="math/tex" id="MathJax-Element-651">Ti = [750, 1500, 2500]</script> in units of K.</li>
</ul>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser
<span class="hljs-keyword">from</span> chemkin.viz <span class="hljs-keyword">import</span> summary

Ti = [<span class="hljs-number">100</span>, <span class="hljs-number">750</span>, <span class="hljs-number">1500</span>, <span class="hljs-number">2500</span>, <span class="hljs-number">5000</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>]

xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))
parsed_data_list = xml_parser.parsed_data_list(Ti)
summary.print_reaction_rate(parsed_data_list, xi)</code></pre>

<ul>
<li>The expected result:</li>
</ul>



<pre class="prettyprint"><code class=" hljs asciidoc">
------At Temperature 100 K------
<span class="hljs-header">Backward reaction coefficients not defined: T=100 is not in some specie's temperature range.
--------------------------------</span>
------At Temperature 750 K------
<span class="hljs-code">     H : 3.42304562795e+16</span>
<span class="hljs-code">     O : -3.38308977852e+16</span>
<span class="hljs-code">     OH : -3.52979102957e+16</span>
<span class="hljs-code">     H2 : 4.07078984572e+13</span>
<span class="hljs-code">     H2O : 5.86479724945e+14</span>
<span class="hljs-code">     O2 : 3.44028050967e+16</span>
<span class="hljs-code">     HO2 : -7.63606068937e+13</span>
<span class="hljs-header">     H2O2 : -5.52803118677e+13
--------------------------------</span>
------At Temperature 1500 K------
<span class="hljs-code">     H : 1.32279654839e+14</span>
<span class="hljs-code">     O : -3.12877268431e+14</span>
<span class="hljs-code">     OH : -1.37621783394e+14</span>
<span class="hljs-code">     H2 : 6.07049182e+13</span>
<span class="hljs-code">     H2O : 6.45299057466e+13</span>
<span class="hljs-code">     O2 : 3.36486898686e+14</span>
<span class="hljs-code">     HO2 : -4.18771319555e+13</span>
<span class="hljs-header">     H2O2 : -1.01625193691e+14
--------------------------------</span>
------At Temperature 2500 K------
<span class="hljs-code">     H : -2.4081673376e+14</span>
<span class="hljs-code">     O : -1.5885953972e+13</span>
<span class="hljs-code">     OH : 3.22268792909e+14</span>
<span class="hljs-code">     H2 : 6.41189812893e+13</span>
<span class="hljs-code">     H2O : 4.70126660046e+13</span>
<span class="hljs-code">     O2 : -2.74831634318e+13</span>
<span class="hljs-code">     HO2 : 5.28617565897e+12</span>
<span class="hljs-header">     H2O2 : -1.54500764698e+14
--------------------------------</span>
------At Temperature 5000 K------
<span class="hljs-header">Backward reaction coefficients not defined: T=5000 is not in some specie's temperature range.
--------------------------------</span></code></pre>



<h3 id="42-a-system-of-reversible-elementary-chemical-reactions">4.2 A system of reversible, elementary chemical reactions</h3>

<ul>
<li>The system of chemical reactions of interest:</li>
</ul>



<p><script type="math/tex; mode=display" id="MathJax-Element-652">
\begin{aligned}
H + O_2 &\longrightarrow O + OH \\
O+ H_2 &\longrightarrow H + OH \\
H_2 + OH &\longrightarrow H_2O + H \\
O + H_2O &\longrightarrow OH + OH \\
HO_2 + H &\longrightarrow H_2 + O_2 \\
HO_2 + H &\longrightarrow OH + OH \\
HO_2 + O &\longrightarrow O_2 + OH \\
HO_2 + OH &\longrightarrow H_2O + O_2 \\
H_2O_2 + H &\longrightarrow H_2O + OH \\
H_2O_2 + H &\longrightarrow HO_2 + H_2 \\
H_2O_2 + O &\longrightarrow OH + HO_2 \\
\end{aligned}
</script></p>

<ul>
<li>Input XML file:</li>
</ul>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0"?&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ctml</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">phase</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">speciesArray</span>&gt;</span> H O OH H2 H2O O2 HO2 H2O2 <span class="hljs-tag">&lt;/<span class="hljs-title">speciesArray</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">phase</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">reactionData</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"hydrogen_air_mechanism"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 01  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction01"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H + O2 =] O + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span>&gt;</span>3.547e+15<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>-0.406<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span>&gt;</span>1.6599e+04<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H:1 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>O:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction02"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction O2  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>O + H2 =] H + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>5.08e+4<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>2.67<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>6.29e+03<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>O:1 H2:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction03"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 03  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H2 + OH =] H2O + H<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>2.16e+08<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>1.51<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>3.43e+03<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H2O:1 H:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction04"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 04  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>O + H2O =] OH + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>2.97e+06<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>2.02<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>1.34e+04<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>O:1 H2O:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>OH:2<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction05"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 10  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>HO2 + H =] H2 + O2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>1.66e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>8.23e+02<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>HO2:1 H:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H2:1 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction06"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 11  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>HO2 + H =] OH + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>7.079e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>2.95e+02<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>HO2:1 H:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>OH:2<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction07"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 12  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>HO2 + O =] O2 + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>3.25e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>HO2:1 O:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>O2:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction08"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 13  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>HO2 + OH =] H2O + O2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>2.890e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>-4.970e+02<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>HO2:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H2O:1 O2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction09"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 17  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H2O2 + H =] H2O + OH<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>2.41e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>3.97e+03<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2O2:1 H:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>H2O:1 OH:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction10"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 18  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H2O2 + H =] HO2 + H2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Arrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>4.82e+13<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>7.95e+03<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Arrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2O2:1 H:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>HO2:1 H2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">reaction</span> <span class="hljs-attribute">reversible</span>=<span class="hljs-value">"yes"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"Elementary"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"reaction11"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- reaction 19  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">equation</span>&gt;</span>H2O2 + O =] OH + HO2<span class="hljs-tag">&lt;/<span class="hljs-title">equation</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">rateCoeff</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">A</span> &gt;</span>9.55e+06<span class="hljs-tag">&lt;/<span class="hljs-title">A</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">b</span>&gt;</span>2.0<span class="hljs-tag">&lt;/<span class="hljs-title">b</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">E</span> &gt;</span>3.970e+03<span class="hljs-tag">&lt;/<span class="hljs-title">E</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">modifiedArrhenius</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">rateCoeff</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">reactants</span>&gt;</span>H2O2:1 O:1<span class="hljs-tag">&lt;/<span class="hljs-title">reactants</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">products</span>&gt;</span>OH:1 HO2:1<span class="hljs-tag">&lt;/<span class="hljs-title">products</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">reaction</span>&gt;</span>

  <span class="hljs-tag">&lt;/<span class="hljs-title">reactionData</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ctml</span>&gt;</span></code></pre>

<p>The following examples demonstrate the visualization functionality of the <code>chemkin</code> library. The user specifies the temperature and initial species concentrations with the corresponding input XML file which contains the reaction data, and the following code plots the time evolution of the species concetration until the reaction reaches equilibrium, as well as the the time until each reaction reaches equilibrium.</p>

<ul>
<li>Given the the species concentration <script type="math/tex" id="MathJax-Element-653">xi = [2.0, 1.0, 0.5, 1.0, 1.0]</script> in units of <script type="math/tex" id="MathJax-Element-654">(mol/dm^3)</script>, calculate the concentrations of species over a pre-specified with temperatures held at two levels: <script type="math/tex" id="MathJax-Element-655">Ti = [100, 1500]</script> (Please note we assume the temperature is held constant in our calculation).</li>
</ul>



<h4 id="421-print-concentration-of-species-at-time-endt">4.2.1 Print Concentration of Species at Time end_t</h4>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser
<span class="hljs-keyword">from</span> chemkin.viz <span class="hljs-keyword">import</span> summary

Ti = [<span class="hljs-number">900</span>, <span class="hljs-number">2500</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>] <span class="hljs-comment"># specie concentrations</span>
xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))

parsed_data_list = xml_parser.parsed_data_list(Ti)

summary.print_species_concentration(parsed_data_list, xi, end_t=<span class="hljs-number">1e-12</span>)</code></pre>

<ul>
<li>The expected result:</li>
</ul>



<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-comment">------At Temperature 900 K------</span>
Specie Concentration <span class="hljs-keyword">at</span> <span class="hljs-built_in">time</span> = <span class="hljs-number">1e-12</span>
  H: start = <span class="hljs-number">2.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">1</span>.<span class="hljs-title">723901712597415</span></span>
  O: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">0</span>.<span class="hljs-title">23872213644765622</span></span>
  OH: start = <span class="hljs-number">0.5</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">0</span>.<span class="hljs-title">027139067877998888</span></span>
  H2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">1</span>.<span class="hljs-title">1618557607172413</span></span>
  H2O: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">2</span>.<span class="hljs-title">4626238490452628</span></span>
  O2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">2</span>.<span class="hljs-title">385757473314534</span></span>
  HO2: start = <span class="hljs-number">0.5</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">6</span>.<span class="hljs-title">056885759728584e-14</span></span>
  H2O2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">6</span>.<span class="hljs-title">5724287182009025e-19</span></span>
<span class="hljs-comment">--------------------------------</span>

<span class="hljs-comment">------At Temperature 2500 K------</span>
Specie Concentration <span class="hljs-keyword">at</span> <span class="hljs-built_in">time</span> = <span class="hljs-number">1e-12</span>
  H: start = <span class="hljs-number">2.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">1</span>.<span class="hljs-title">2148570014216886</span></span>
  O: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">0</span>.<span class="hljs-title">9791302354930477</span></span>
  OH: start = <span class="hljs-number">0.5</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">0</span>.<span class="hljs-title">9111019320202484</span></span>
  H2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">0</span>.<span class="hljs-title">7430549709243639</span></span>
  H2O: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">2</span>.<span class="hljs-title">6939438877946014</span></span>
  O2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">1</span>.<span class="hljs-title">4578690352649595</span></span>
  HO2: start = <span class="hljs-number">0.5</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">4</span>.<span class="hljs-title">252504205019055e-05</span></span>
  H2O2: start = <span class="hljs-number">1.0</span>, <span class="hljs-function"><span class="hljs-keyword">end</span> = <span class="hljs-title">4</span>.<span class="hljs-title">120390407757191e-07</span></span>
<span class="hljs-comment">--------------------------------</span></code></pre>



<h4 id="422-print-time-to-reach-equilibrium">4.2.2 Print Time to Reach Equilibrium</h4>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser
<span class="hljs-keyword">from</span> chemkin.viz <span class="hljs-keyword">import</span> summary

Ti = [<span class="hljs-number">900</span>, <span class="hljs-number">2500</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>] <span class="hljs-comment"># specie concentrations</span>
xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))

parsed_data_list = xml_parser.parsed_data_list(Ti)

summary.print_time_to_equilibrium(parsed_data_list, xi)</code></pre>

<ul>
<li>The expected result:</li>
</ul>



<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-comment">------At Temperature 900 K------</span>
Time <span class="hljs-built_in">to</span> Equilibrium (end_t = <span class="hljs-number">10000000000.0</span>)
  Reaction <span class="hljs-comment">#0: 1.7710385756438292e-05</span>
  Reaction <span class="hljs-comment">#1: 1.7710385756438292e-05</span>
  Reaction <span class="hljs-comment">#2: 1.773464177804173e-07</span>
  Reaction <span class="hljs-comment">#3: 1.773464177804173e-07</span>
  Reaction <span class="hljs-comment">#4: 2.1808938174999524e-11</span>
  Reaction <span class="hljs-comment">#5: 2.1808938174999524e-11</span>
  Reaction <span class="hljs-comment">#6: 1.743709840167672e-11</span>
  Reaction <span class="hljs-comment">#7: 1.4245072821790747e-11</span>
  Reaction <span class="hljs-comment">#8: 8.557334002807858e-13</span>
  Reaction <span class="hljs-comment">#9: 1.3523084464099764e-12</span>
  Reaction <span class="hljs-comment">#10: 7.872345307371005e-13</span>

Overall Time <span class="hljs-built_in">to</span> Equilibrium: <span class="hljs-number">1.7710385756438292e-05</span>
<span class="hljs-comment">--------------------------------</span>

<span class="hljs-comment">------At Temperature 2500 K------</span>
Time <span class="hljs-built_in">to</span> Equilibrium (end_t = <span class="hljs-number">10000000000.0</span>)
  Reaction <span class="hljs-comment">#0: 3.28928631333613e-08</span>
  Reaction <span class="hljs-comment">#1: 32892533.73554649</span>
  Reaction <span class="hljs-comment">#2: 3289253.373554649</span>
  Reaction <span class="hljs-comment">#3: 0.0032892533738840468</span>
  Reaction <span class="hljs-comment">#4: 3.322193155035267e-11</span>
  Reaction <span class="hljs-comment">#5: 3.292547351702711e-10</span>
  Reaction <span class="hljs-comment">#6: 3.292547351702711e-10</span>
  Reaction <span class="hljs-comment">#7: 3.292547351702711e-10</span>
  Reaction <span class="hljs-comment">#8: 3.322193155035267e-11</span>
  Reaction <span class="hljs-comment">#9: 3.322193155035267e-11</span>
  Reaction <span class="hljs-comment">#10: 3.292547351702711e-10</span>

Overall Time <span class="hljs-built_in">to</span> Equilibrium: The <span class="hljs-keyword">system</span> has <span class="hljs-operator">not</span> yet reached equilibrium.
<span class="hljs-comment">--------------------------------</span></code></pre>



<h4 id="423-plot-time-evolution-of-concentration-species">4.2.3 Plot Time Evolution of Concentration Species</h4>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser
<span class="hljs-keyword">from</span> chemkin.viz <span class="hljs-keyword">import</span> summary

Ti = [<span class="hljs-number">900</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>] <span class="hljs-comment"># specie concentrations</span>
xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))

parsed_data_list = xml_parser.parsed_data_list(Ti)

summary.plot_species_concentration(parsed_data_list, xi)</code></pre>

<ul>
<li>See the expected image <a href="https://github.com/G12-cs207-FinalProject/cs207-FinalProject/blob/master/chemkin/viz/examples/evolution_900K.png">here</a></li>
</ul>



<h4 id="424-plot-time-to-equilibrium">4.2.4 Plot Time to Equilibrium</h4>



<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">from</span> chemkin <span class="hljs-keyword">import</span> pckg_xml_path
<span class="hljs-keyword">from</span> chemkin.preprocessing.parse_xml <span class="hljs-keyword">import</span> XmlParser
<span class="hljs-keyword">from</span> chemkin.viz <span class="hljs-keyword">import</span> summary

Ti = [<span class="hljs-number">900</span>]
xi = [<span class="hljs-number">2.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">.5</span>, <span class="hljs-number">1.</span>] <span class="hljs-comment"># specie concentrations</span>
xml_parser = XmlParser(pckg_xml_path(<span class="hljs-string">'rxns_reversible'</span>))

parsed_data_list = xml_parser.parsed_data_list(Ti)

summary.plot_time_to_equilibrium(parsed_data_list, xi)
</code></pre>

<ul>
<li>See the expected image <a href="https://github.com/G12-cs207-FinalProject/cs207-FinalProject/blob/master/chemkin/viz/examples/Time_to_Equilibrium_900K.png">here</a></li>
</ul>

<p>The demo code for this example can be found in the library GitHub repo in the module <code>demo_ODEsolver.py</code> <a href="https://github.com/G12-cs207-FinalProject/cs207-FinalProject">here</a>.</p>



<h3 id="5-new-feature">5. New Feature</h3>

<p>Our new implemented feature is a differential equation solver that calculates species concentrations as a function of time as well as determines the time for each reaction to reach an equilibrium. </p>

<p>We implemented a numerical iterative solver of an Ordinary Differential Equation (ODE) under the assumption an ODE models the time evolution of the species concentration in the chemical system at hand.</p>

<p>This new feature enables the library to:</p>

<ol>
<li>Given an end-time (<script type="math/tex" id="MathJax-Element-656">t_{end}</script>) and reaction data, output the concentrations of each species at <script type="math/tex" id="MathJax-Element-657">t_{end}</script>.</li>
<li>Given reaction data, output the time to reach equilibrium (in the case of reversible elementary reactions) or the time for the reaction to reach completion (in the case of irreversible elementary reactions).</li>
<li>Given an end-time (<script type="math/tex" id="MathJax-Element-658">t_{end}</script>), function plots the time evolution of species concentrations from <script type="math/tex" id="MathJax-Element-659">t_0</script> to <script type="math/tex" id="MathJax-Element-660">t_{end}</script>.</li>
</ol>



<h5 id="51-motivation">5.1 Motivation</h5>

<p>We motivate our feature by the following:</p>

<ul>
<li>Visualize the change in species concentration over time.</li>
<li>Identify time for each reaction to reach equilibrium as well as the time when the overall chemical system achieves equilibrium (i.e., reaction completion).</li>
<li>Get the concentrations at some end time (<script type="math/tex" id="MathJax-Element-661">t_{end}</script>) for each specie.</li>
</ul>

<p>For the end-user, it may be useful to learn about the concentration of the various species at any given point in time (as opposed to just the reaction rates). Additionally, visualization of the gradient of change in concentration may help the user make a decision about an experiment design in e.g., time to cut off a titration experiment or a batch chemical synthesis.</p>

<p>In the future, the library could be enhanced by relaxing the condition of fixed temperature to further enable the user to get insights on more complex systems.</p>



<h5 id="52-implementation-details">5.2 Implementation Details</h5>

<p>In the next section, we discuss the functionality of the <code>chemkin</code> ODE solver as well as new methods that realize the 3  additional features listed above (i.e. 1 - Calculate the concentrations of each species at a given <script type="math/tex" id="MathJax-Element-766">t_{end}</script>; 2- Calculate the time to reach equilibrium; and 3 - Plot time evolution of species concentration and time to equilibrium.</p>

<h5 id="521-odeintsolver">5.2.1 <code>ODE_int_solver</code></h5>

<p>The class <code>ODE_int_solver</code> is contained in the <code>ODEint_solver.py</code> module in the <code>solver</code> package. The <code>ODE_int_solver</code> class is the workhorse to solve concentration of species over time as well as time to reach the equilibrium. </p>

<p>Attributes of <code>ODE_int_solver</code>:</p>

<ul>
<li><code>temp</code>: float, temperature for reaction (assumed to be held constant).</li>
<li><code>rxn</code>: an instance of the <code>ElementaryRxn()</code> object</li>
<li><code>species_equil_thresh</code>: (float, default 1e-5): Species concentration <br>
evolution  is defined to reach equilibrium once <code>np.abs(bw - fw) &lt; species_equil_thresh</code>, where <code>(bw - fw)</code> is the difference in backward and forward progress rates for that species.</li>
<li><code>overall_equil_thresh</code>: (float, default 1e-2), overall reaction is defined to reach equilibrium once <code>np.linalg.norm(prograte_diff) &lt; overall_equil_thresh</code>, where <code>prograte_diff</code>is the difference in the backward and forward progress rate vectors of the reaction.</li>
<li><code>critical_t</code>: List of floats of len(ki). Stores time(s) at which reaction’s component species’ concentrations reach equilibrium.</li>
<li><code>overall_critical_t</code>: float, stores time at which overall reaction reaches equilibrium</li>
<li><code>max_t</code>: float, maximum time allowed for the solver</li>
</ul>

<p><code>ODE_int_solver</code> objects have the following method:</p>

<ul>
<li><p><code>solve(time_int)</code> method: </p>

<ul><li>Input: the time interval (a list of floats) over which the <code>odeint</code> numerical integrator will iteratively solve for the concentration of reaction species over time.</li>
<li><p>Output:  <br>
1) sol: the list of lists (type: numpy array) for concentrations of each specie over the <code>time_int</code> time interval. <br>
2) critical_t: time for each reaction to reach equilibrium <br>
2) overall_t: time for the overall system to reach equilibrium</p></li>
<li><p><code>rxn_rate()</code>: function (dx/dt) passed to the <code>odeint</code> solver to perform the numerical integration. Once the difference of backward and forward coefficients falls below a pre-defined threshold <code>species_equil_thresh</code>, the respective species time to reach equilibrium and in similar manner for <code>overall_equil_thresh</code> the overall reaction equilibrium time are recorded. </p></li>
<li><p>the <code>solve()</code> method utilizes an external ODE solver, namely the <code>odeint</code> from <code>scipy.integrate</code>. </p></li>
<li><p>The solver initializes with list of starting species concentrations stored as the attribute <code>xi</code> of the <code>ElementaryRxn</code> object. Then, in each iteration, the solver numerically integrates the concentration <code>xi</code> attribute of the passed <code>ElementaryRxn</code> object  via the <code>rxn_rate()</code> function. Finally, the new reaction rates of the <code>ElementaryRxn</code> based on updated concentrations are calculated via <code>ElementaryRxn</code> object method <code>reaction_rate</code>.</p></li></ul></li>
</ul>

<p><strong>Note</strong> In our implementation, the methods <code>species_concentration()</code>, <code>species_concentration_evolution()</code>, and <code>time_to_equilibrium()</code> from the <code>RxnBase</code> class create an instance of the <code>ODE_int_solver</code> object in order to solve for concentration time evolution and equilibrium, respectively. These methods are discussed in the next section.</p>

<h5 id="522-added-methods-in-rxnbase-class">5.2.2 Added methods in <code>RxnBase</code> class</h5>

<ul>
<li><p><code>species_concentration(self, T, end_t, n_steps=101)</code>: Returns a list of species concentrations at temperature = T and end time = end_t (n_steps specifies the number of time steps for the ODE solver)</p></li>
<li><p><code>species_concentration_evolution(self, T, end_t, n_steps=101)</code>:  Returns a matrix of species concentration evolution at temperature = T and from start to end_t  (n_steps specifies the number of time steps for the ODE solver)</p></li>
<li><p><code>time_to_equilibrium(self, T, n_steps=101)</code>: Returns the list of time to equilibrium of all the reactions and the time to equilibrium of the overall system at temperature = T  (n_steps specifies the number of time steps for the ODE solver)</p></li>
</ul>

<h5 id="522-viz-package">5.2.2  <code>viz</code>  package</h5>

<p>The <code>viz</code> package contains the <code>summary</code> module allows various visualizations of kinetic parameters of interest.</p>

<p>The methods in the <code>summary</code> module is roughly divided into 2 high-level functions: 1) printing kinetic parameters of interest in prettified tabular format; and 2) plotting kinetic parameters of interest </p>

<p>For printing tables of kinetic parameters:</p>

<ul>
<li><p><code>print_reaction_rate(parsed_data_list, xi)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. The method prints reactions rates in tabular format. </p></li>
<li><p><code>print_species_concentration(parsed_data_list, xi, n_steps=101, end_t=1e-12)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method, species concentrations <code>xi</code>, and an end-time <code>end_t</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method prints species concentration at <code>end_t</code> in tabular format. </p></li>
<li><p><code>print_time_to_equilibrium(parsed_data_list, xi, n_steps=101)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method prints time to reach equilibrium for each reaction in the system. </p></li>
</ul>

<p>For plotting kinetic parameters:</p>

<ul>
<li><p><code>plot_species_concentration(parsed_data_list, xi, n_steps=101, end_t=1e-12)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method, species concentrations <code>xi</code>, and an end-time <code>end_t</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method saves the line plot to the <code>viz/examples</code> directory. </p></li>
<li><p><code>plot_time_to_equilibrium(parsed_data_list, xi, n_steps=101)</code>: Takes in parsed reaction data from the output of <code>XMLparser</code> object’s <code>parsed_data_list(Ti)</code> method and species concentrations <code>xi</code>. User can also specify <code>n_steps</code>, which the number of time steps the ODE solver uses to integrate differential equations. The method saves the bar chart to the <code>viz/examples</code> directory. </p></li>
</ul>